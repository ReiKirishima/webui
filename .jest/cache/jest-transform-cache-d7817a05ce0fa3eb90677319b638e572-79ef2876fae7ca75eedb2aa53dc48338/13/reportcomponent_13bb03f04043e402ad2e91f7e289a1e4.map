{"file":"/Users/macbook/karpov-work/TrueNAS/webui/src/app/pages/reports-dashboard/components/report/report.component.ts","mappings":"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","names":[],"sources":["/Users/macbook/karpov-work/TrueNAS/webui/src/app/pages/reports-dashboard/components/report/report.component.ts"],"sourcesContent":["import { DOCUMENT } from '@angular/common';\nimport {\n  Component,\n  Input,\n  ViewChild,\n  OnChanges,\n  OnInit, Inject, ChangeDetectionStrategy, ChangeDetectorRef,\n} from '@angular/core';\nimport { UntilDestroy, untilDestroyed } from '@ngneat/until-destroy';\nimport { Store } from '@ngrx/store';\nimport { TranslateService } from '@ngx-translate/core';\nimport { UUID } from 'angular2-uuid';\nimport {\n  add, isToday, sub,\n} from 'date-fns';\nimport { cloneDeep } from 'lodash-es';\nimport {\n  BehaviorSubject, Subscription, timer,\n} from 'rxjs';\nimport {\n  delay, distinctUntilChanged, filter, skipWhile, throttleTime,\n} from 'rxjs/operators';\nimport { invalidDate } from 'app/constants/invalid-date';\nimport { oneDayMillis, oneHourMillis } from 'app/constants/time.constant';\nimport { toggleMenuDuration } from 'app/constants/toggle-menu-duration';\nimport { EmptyType } from 'app/enums/empty-type.enum';\nimport { ReportingGraphName } from 'app/enums/reporting.enum';\nimport { ReportingData, ReportingDatabaseError } from 'app/interfaces/reporting.interface';\nimport { IxSimpleChanges } from 'app/interfaces/simple-changes.interface';\nimport { WebSocketError } from 'app/interfaces/websocket-error.interface';\nimport { FormatDateTimePipe } from 'app/modules/pipes/format-date-time/format-datetime.pipe';\nimport { LineChartComponent } from 'app/pages/reports-dashboard/components/line-chart/line-chart.component';\nimport { ReportStepDirection } from 'app/pages/reports-dashboard/enums/report-step-direction.enum';\nimport { ReportZoomLevel, zoomLevelLabels } from 'app/pages/reports-dashboard/enums/report-zoom-level.enum';\nimport {\n  DateTime, LegendDataWithStackedTotalHtml, Report, FetchReportParams, TimeAxisData, TimeData,\n} from 'app/pages/reports-dashboard/interfaces/report.interface';\nimport { refreshInterval } from 'app/pages/reports-dashboard/reports.constants';\nimport { ReportsService } from 'app/pages/reports-dashboard/reports.service';\nimport { formatData } from 'app/pages/reports-dashboard/utils/report.utils';\nimport { LocaleService } from 'app/services/locale.service';\nimport { ThemeService } from 'app/services/theme/theme.service';\nimport { AppState } from 'app/store';\nimport { selectTheme, waitForPreferences } from 'app/store/preferences/preferences.selectors';\nimport { selectTimezone } from 'app/store/system-config/system-config.selectors';\n\n@UntilDestroy()\n@Component({\n  selector: 'ix-report',\n  templateUrl: './report.component.html',\n  styleUrls: ['./report.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ReportComponent implements OnInit, OnChanges {\n  @Input() localControls?: boolean = true;\n  @Input() dateFormat?: DateTime;\n  @Input() report: Report;\n  @Input() identifier?: string;\n  @ViewChild(LineChartComponent, { static: false }) lineChart: LineChartComponent;\n\n  updateReport$ = new BehaviorSubject<IxSimpleChanges<this>>(null);\n  fetchReport$ = new BehaviorSubject<FetchReportParams>(null);\n  autoRefreshTimer: Subscription;\n  autoRefreshEnabled: boolean;\n  isReady = false;\n  data: ReportingData;\n  chartId = `chart-${UUID.UUID()}`;\n  chartColors: string[];\n  legendData: LegendDataWithStackedTotalHtml = {} as LegendDataWithStackedTotalHtml;\n  subtitle: string = this.translate.instant('% of all cores');\n  isActive = true;\n  stepForwardDisabled = true;\n  stepBackDisabled = false;\n  timezone: string;\n  lastEndDateForCurrentZoomLevel = {\n    '60m': null as number,\n    '24h': null as number,\n    '7d': null as number,\n    '1M': null as number,\n    '6M': null as number,\n  };\n  currentStartDate: number;\n  currentEndDate: number;\n  customZoom = false;\n  zoomLevelMax = Object.keys(ReportZoomLevel).length - 1;\n  zoomLevelMin = 0;\n  zoomLevelIndex = this.zoomLevelMax;\n  zoomLevels: TimeAxisData[] = [\n    { timespan: ReportZoomLevel.HalfYear, timeformat: \"%b '%y\", culling: 6 },\n    { timespan: ReportZoomLevel.Month, timeformat: 'Week %W', culling: 4 },\n    { timespan: ReportZoomLevel.Week, timeformat: '%d %b', culling: 6 },\n    { timespan: ReportZoomLevel.Day, timeformat: '%a %H:%M', culling: 4 },\n    { timespan: ReportZoomLevel.Hour, timeformat: '%H:%M', culling: 6 },\n  ];\n  readonly zoomLevelLabels = zoomLevelLabels;\n\n  get reportTitle(): string {\n    const trimmed = this.report.title.replace(/[()]/g, '');\n    return this.identifier ? trimmed.replace(/{identifier}/, this.identifier) : this.report.title;\n  }\n\n  get zoomInDisabled(): boolean {\n    return this.zoomLevelIndex >= this.zoomLevelMax;\n  }\n\n  get zoomOutDisabled(): boolean {\n    return this.zoomLevelIndex <= this.zoomLevelMin;\n  }\n\n  get currentZoomLevel(): ReportZoomLevel {\n    return this.zoomLevels[this.zoomLevelIndex].timespan;\n  }\n\n  get isStacked(): boolean {\n    return [\n      ReportingGraphName.Cpu,\n      ReportingGraphName.Processes,\n      ReportingGraphName.Uptime,\n      ReportingGraphName.ZfsArcResult,\n    ].includes(this.data?.name as ReportingGraphName);\n  }\n\n  get shouldShowTotal(): boolean {\n    return [\n      ReportingGraphName.ZfsArcResult,\n      ReportingGraphName.Memory,\n    ].includes(this.data?.name as ReportingGraphName);\n  }\n\n  get shouldShowLegendValue(): boolean {\n    return this.chartId === this.legendData?.chartId;\n  }\n\n  constructor(\n    public translate: TranslateService,\n    private store$: Store<AppState>,\n    private formatDateTimePipe: FormatDateTimePipe,\n    private themeService: ThemeService,\n    private reportsService: ReportsService,\n    private cdr: ChangeDetectorRef,\n    private localeService: LocaleService,\n    @Inject(DOCUMENT) private document: Document,\n  ) {\n    this.reportsService.legendEventEmitterObs$.pipe(untilDestroyed(this)).subscribe({\n      next: (data: LegendDataWithStackedTotalHtml) => {\n        const clone = { ...data };\n        clone.xHTML = this.formatTime(data.x);\n        this.legendData = clone as LegendDataWithStackedTotalHtml;\n        this.cdr.markForCheck();\n      },\n    });\n\n    this.store$.select(selectTheme).pipe(\n      filter(Boolean),\n      untilDestroyed(this),\n    ).subscribe(() => {\n      this.chartColors = this.themeService.getColorPattern();\n    });\n\n    this.store$.select(selectTimezone).pipe(untilDestroyed(this)).subscribe((timezone) => {\n      this.timezone = timezone;\n    });\n\n    this.store$.pipe(\n      waitForPreferences,\n      filter(() => Boolean(this.lineChart?.chart)),\n      delay(toggleMenuDuration),\n      untilDestroyed(this),\n    ).subscribe(() => {\n      this.lineChart.chart.resize();\n    });\n\n    this.store$.pipe(\n      waitForPreferences,\n      untilDestroyed(this),\n    ).subscribe((preferences) => {\n      this.autoRefreshEnabled = preferences.autoRefreshReports;\n      if (this.autoRefreshEnabled && !this.autoRefreshTimer) {\n        this.initAutoRefresh();\n      }\n    });\n\n    this.fetchReport$.pipe(\n      filter((params) => !!params),\n      throttleTime(100),\n      skipWhile(() => this.document.hidden),\n      distinctUntilChanged(),\n      untilDestroyed(this),\n    ).subscribe((params) => {\n      this.fetchReportData(params);\n    });\n\n    this.updateReport$.pipe(\n      filter((changes) => Boolean(changes?.report)),\n      throttleTime(100),\n      skipWhile(() => this.document.hidden),\n      distinctUntilChanged(),\n      untilDestroyed(this),\n    ).subscribe((changes) => {\n      this.applyChanges(changes);\n    });\n  }\n\n  initAutoRefresh(): void {\n    this.autoRefreshTimer = timer(2000, refreshInterval).pipe(\n      filter(() => this.autoRefreshEnabled),\n      untilDestroyed(this),\n    ).subscribe(() => {\n      const rrdOptions = this.convertTimeSpan(this.currentZoomLevel);\n      this.currentStartDate = rrdOptions.start;\n      this.currentEndDate = rrdOptions.end;\n\n      const identifier = this.report.identifiers ? this.report.identifiers[0] : null;\n      this.fetchReport$.next({ rrdOptions, identifier, report: this.report });\n    });\n  }\n\n  ngOnChanges(changes: IxSimpleChanges<this>): void {\n    const wasReportChanged = changes?.report?.firstChange\n      || (changes.report.previousValue && !this.isReady)\n      || (changes.report.previousValue.title !== changes.report.currentValue.title);\n\n    if (wasReportChanged) {\n      this.updateReport$.next(changes);\n    }\n  }\n\n  ngOnInit(): void {\n    const { start, end } = this.convertTimeSpan(this.currentZoomLevel);\n    this.currentStartDate = start;\n    this.currentEndDate = end;\n    this.stepForwardDisabled = true;\n\n    if (!this.isReady) {\n      setTimeout(() => {\n        this.isReady = true;\n        this.cdr.markForCheck();\n      }, 1000);\n    }\n  }\n\n  formatTime(stamp: number): string {\n    const result = this.formatDateTimePipe.transform(new Date(stamp));\n    return result.toLowerCase() !== invalidDate.toLowerCase() ? result : null;\n  }\n\n  onZoomChange(interval: number[]): void {\n    const [startDate, endDate] = interval;\n    this.currentStartDate = startDate;\n    this.currentEndDate = endDate;\n    this.customZoom = true;\n  }\n\n  setChartInteractive(value: boolean): void {\n    this.isActive = value;\n  }\n\n  timeZoomReset(): void {\n    this.zoomLevelIndex = this.zoomLevelMax;\n    const rrdOptions = this.convertTimeSpan(this.currentZoomLevel);\n    this.currentStartDate = rrdOptions.start;\n    this.currentEndDate = rrdOptions.end;\n    this.customZoom = false;\n    const identifier = this.report.identifiers ? this.report.identifiers[0] : null;\n    this.fetchReport$.next({ rrdOptions, identifier, report: this.report });\n    this.clearLastEndDateForCurrentZoomLevel();\n  }\n\n  clearLastEndDateForCurrentZoomLevel(): void {\n    Object.keys(this.lastEndDateForCurrentZoomLevel).forEach((key: ReportZoomLevel) => {\n      this.lastEndDateForCurrentZoomLevel[key] = null;\n    });\n  }\n\n  timeZoomIn(): void {\n    if (this.zoomLevelIndex === this.zoomLevelMax) {\n      return;\n    }\n\n    this.lastEndDateForCurrentZoomLevel[this.currentZoomLevel] = this.currentEndDate;\n    this.zoomLevelIndex += 1;\n\n    let currentDate = (this.currentStartDate + this.currentEndDate) / 2;\n\n    if (this.stepForwardDisabled || isToday(this.currentEndDate)) {\n      currentDate = this.currentEndDate;\n    }\n\n    const rrdOptions = this.convertTimeSpan(this.currentZoomLevel, ReportStepDirection.Backward, currentDate);\n\n    this.currentStartDate = rrdOptions.start;\n    this.currentEndDate = rrdOptions.end;\n    this.customZoom = false;\n    const identifier = this.report.identifiers ? this.report.identifiers[0] : null;\n    this.fetchReport$.next({ rrdOptions, identifier, report: this.report });\n  }\n\n  timeZoomOut(): void {\n    if (this.zoomLevelIndex === this.zoomLevelMin) {\n      return;\n    }\n    this.zoomLevelIndex -= 1;\n\n    const halfPeriodMilliseconds = this.getHalfPeriodMilliseconds();\n\n    let currentDate = this.lastEndDateForCurrentZoomLevel[this.currentZoomLevel]\n      || ((this.currentStartDate + this.currentEndDate) / 2) + halfPeriodMilliseconds;\n\n    if (this.stepForwardDisabled || isToday(this.currentEndDate)) {\n      currentDate = this.currentEndDate;\n    }\n\n    const rrdOptions = this.convertTimeSpan(this.currentZoomLevel, ReportStepDirection.Backward, currentDate);\n\n    this.currentStartDate = rrdOptions.start;\n    this.currentEndDate = rrdOptions.end;\n    this.customZoom = false;\n    this.lastEndDateForCurrentZoomLevel[this.currentZoomLevel] = null;\n    const identifier = this.report.identifiers ? this.report.identifiers[0] : null;\n    this.fetchReport$.next({ rrdOptions, identifier, report: this.report });\n  }\n\n  stepBack(): void {\n    if (this.stepBackDisabled) {\n      return;\n    }\n\n    this.clearLastEndDateForCurrentZoomLevel();\n\n    const rrdOptions = this.convertTimeSpan(\n      this.currentZoomLevel,\n      ReportStepDirection.Backward,\n      this.currentStartDate,\n    );\n    this.currentStartDate = rrdOptions.start;\n    this.currentEndDate = rrdOptions.end;\n\n    const identifier = this.report.identifiers ? this.report.identifiers[0] : null;\n    this.fetchReport$.next({ rrdOptions, identifier, report: this.report });\n  }\n\n  stepForward(): void {\n    if (this.stepForwardDisabled) {\n      return;\n    }\n\n    this.clearLastEndDateForCurrentZoomLevel();\n\n    const rrdOptions = this.convertTimeSpan(\n      this.currentZoomLevel,\n      ReportStepDirection.Forward,\n      this.currentEndDate,\n    );\n    this.currentStartDate = rrdOptions.start;\n    this.currentEndDate = rrdOptions.end;\n\n    const identifier = this.report.identifiers ? this.report.identifiers[0] : null;\n    this.fetchReport$.next({ rrdOptions, identifier, report: this.report });\n  }\n\n  getDateFromString(timestamp: string): Date {\n    return this.localeService.getDateFromString(timestamp, this.timezone);\n  }\n\n  // Convert timespan to start/end options\n  convertTimeSpan(\n    timespan: ReportZoomLevel,\n    direction = ReportStepDirection.Backward,\n    currentDate?: number,\n  ): TimeData {\n    const duration = this.getTimespan(timespan);\n    const now = new Date();\n    let startDate: Date;\n    let endDate: Date;\n\n    if (direction === ReportStepDirection.Backward && !currentDate) {\n      endDate = now;\n    } else if (direction === ReportStepDirection.Backward && currentDate) {\n      endDate = new Date(currentDate);\n    } else if (direction === ReportStepDirection.Forward && currentDate) {\n      startDate = new Date(currentDate);\n    } else {\n      throw new Error(\n        'A current date parameter must be specified when stepping forward in time!\\n direction specified was ' + direction,\n      );\n    }\n\n    if (direction === ReportStepDirection.Backward) {\n      startDate = sub(endDate, duration);\n    } else if (direction === ReportStepDirection.Forward) {\n      endDate = add(startDate, duration);\n    }\n\n    // if endDate is in the future, reset with endDate to now\n    if (endDate.getTime() >= now.getTime()) {\n      endDate = now;\n      startDate = sub(endDate, duration);\n      this.stepForwardDisabled = true;\n    } else {\n      this.stepForwardDisabled = false;\n    }\n\n    if (startDate.getFullYear() <= 1999) {\n      this.stepBackDisabled = true;\n    } else {\n      this.stepBackDisabled = false;\n    }\n\n    return {\n      start: startDate.getTime(),\n      end: endDate.getTime(),\n      step: '10',\n    };\n  }\n\n  getTimespan(zoomLevel: ReportZoomLevel): Record<string, number> {\n    let durationUnit: keyof Duration;\n    let value: number;\n\n    switch (zoomLevel) {\n      case ReportZoomLevel.HalfYear:\n        durationUnit = 'months';\n        value = 6;\n        break;\n      case ReportZoomLevel.Month:\n        durationUnit = 'months';\n        value = 1;\n        break;\n      case ReportZoomLevel.Week:\n        durationUnit = 'days';\n        value = 7;\n        break;\n      case ReportZoomLevel.Day:\n        durationUnit = 'hours';\n        value = 24;\n        break;\n      case ReportZoomLevel.Hour:\n        durationUnit = 'minutes';\n        value = 60;\n        break;\n    }\n    return { [durationUnit]: value };\n  }\n\n  fetchReportData(fetchParams: FetchReportParams): void {\n    const { report, identifier, rrdOptions } = fetchParams;\n    // Report options\n    const params = identifier ? { name: report.name, identifier } : { name: report.name };\n\n    // Time scale options\n    const start = Math.floor(rrdOptions.start / 1000);\n    const end = Math.floor(rrdOptions.end / 1000);\n    const timeFrame = { start, end };\n\n    this.reportsService.getNetData({\n      report,\n      params,\n      timeFrame,\n      truncate: this.stepForwardDisabled,\n    }).pipe(\n      skipWhile(() => this.document.hidden),\n      untilDestroyed(this),\n    ).subscribe({\n      next: (event) => {\n        this.data = formatData(cloneDeep(event));\n        this.cdr.markForCheck();\n      },\n      error: (err: WebSocketError) => {\n        this.handleError(err);\n        this.cdr.markForCheck();\n      },\n    });\n  }\n\n  handleError(err: WebSocketError): void {\n    if (err?.error === (ReportingDatabaseError.FailedExport as number)) {\n      this.report.errorConf = {\n        type: EmptyType.Errors,\n        title: this.translate.instant('Error getting chart data'),\n        message: err.reason,\n      };\n    }\n  }\n\n  private applyChanges(changes: IxSimpleChanges<this>): void {\n    const rrdOptions = this.convertTimeSpan(this.currentZoomLevel);\n    const identifier = changes.report.currentValue.identifiers ? changes.report.currentValue.identifiers[0] : null;\n    this.fetchReport$.next({ rrdOptions, identifier, report: changes.report.currentValue });\n  }\n\n  private getHalfPeriodMilliseconds(): number {\n    switch (this.currentZoomLevel) {\n      case ReportZoomLevel.Hour:\n        return (1 * oneHourMillis) / 2;\n      case ReportZoomLevel.Day:\n        return (1 * oneDayMillis) / 2;\n      case ReportZoomLevel.Week:\n        return (7 * oneDayMillis) / 2;\n      case ReportZoomLevel.Month:\n        return (30 * oneDayMillis) / 2;\n      case ReportZoomLevel.HalfYear:\n        return (365 * oneDayMillis) / 2;\n      default:\n        return 0;\n    }\n  }\n}\n"],"version":3}