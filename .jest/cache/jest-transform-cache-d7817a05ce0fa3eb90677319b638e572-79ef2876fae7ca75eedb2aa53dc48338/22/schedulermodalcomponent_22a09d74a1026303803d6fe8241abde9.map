{"file":"/Users/macbook/karpov-work/TrueNAS/webui/src/app/modules/scheduler/components/scheduler-modal/scheduler-modal.component.ts","mappings":"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","names":[],"sources":["/Users/macbook/karpov-work/TrueNAS/webui/src/app/modules/scheduler/components/scheduler-modal/scheduler-modal.component.ts"],"sourcesContent":["import {\n  ChangeDetectionStrategy, Component, Inject, OnInit,\n} from '@angular/core';\nimport { Validators } from '@angular/forms';\nimport { MAT_DIALOG_DATA, MatDialogRef } from '@angular/material/dialog';\nimport { FormBuilder, FormControl } from '@ngneat/reactive-forms';\nimport { UntilDestroy, untilDestroyed } from '@ngneat/until-destroy';\nimport { Store } from '@ngrx/store';\nimport { TranslateService } from '@ngx-translate/core';\nimport * as cronParser from 'cron-parser';\nimport { DayOfTheWeekRange, MonthRange } from 'cron-parser/types';\nimport { of } from 'rxjs';\nimport { helptextGlobal } from 'app/helptext/global-helptext';\nimport { Option } from 'app/interfaces/option.interface';\nimport {\n  SchedulerModalConfig,\n} from 'app/modules/scheduler/components/scheduler-modal/scheduler-modal-config.interface';\nimport {\n  CrontabPart,\n  CrontabPartValidatorService,\n} from 'app/modules/scheduler/services/crontab-part-validator.service';\nimport { getDefaultCrontabPresets } from 'app/modules/scheduler/utils/get-default-crontab-presets.utils';\nimport { AppState } from 'app/store';\nimport { selectTimezone } from 'app/store/system-config/system-config.selectors';\n\n@UntilDestroy()\n@Component({\n  selector: 'ix-scheduler-modal',\n  templateUrl: './scheduler-modal.component.html',\n  styleUrls: ['./scheduler-modal.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class SchedulerModalComponent implements OnInit {\n  protected form = this.formBuilder.group({\n    preset: [''],\n    minutes: ['', [Validators.required, this.validators.crontabPartValidator(CrontabPart.Minutes)]],\n    hours: ['', [Validators.required, this.validators.crontabPartValidator(CrontabPart.Hours)]],\n    days: ['', [Validators.required, this.validators.crontabPartValidator(CrontabPart.Days)]],\n    months: this.formBuilder.group<Record<string, boolean>>({}),\n    weekdays: this.formBuilder.group({\n      mon: [false],\n      tue: [false],\n      wed: [false],\n      thu: [false],\n      fri: [false],\n      sat: [false],\n      sun: [false],\n    }),\n  });\n\n  crontab: string;\n  timezone: string;\n\n  // TODO: This belongs elsewhere, for example in date-fns.\n  readonly months: Option[] = [\n    { label: this.translate.instant('Jan'), value: '1' },\n    { label: this.translate.instant('Feb'), value: '2' },\n    { label: this.translate.instant('Mar'), value: '3' },\n    { label: this.translate.instant('Apr'), value: '4' },\n    { label: this.translate.instant('May'), value: '5' },\n    { label: this.translate.instant('Jun'), value: '6' },\n    { label: this.translate.instant('Jul'), value: '7' },\n    { label: this.translate.instant('Aug'), value: '8' },\n    { label: this.translate.instant('Sep'), value: '9' },\n    { label: this.translate.instant('Oct'), value: '10' },\n    { label: this.translate.instant('Nov'), value: '11' },\n    { label: this.translate.instant('Dec'), value: '12' },\n  ];\n\n  // TODO: This belongs elsewhere.\n  // TODO: Not every locale uses Sun as first day of the week.\n  // TODO: Update in harness too.\n  // TODO: Limit type.\n  readonly weekdays: Option[] = [\n    { label: this.translate.instant('Sun'), value: 'sun' },\n    { label: this.translate.instant('Mon'), value: 'mon' },\n    { label: this.translate.instant('Tue'), value: 'tue' },\n    { label: this.translate.instant('Wed'), value: 'wed' },\n    { label: this.translate.instant('Thu'), value: 'thu' },\n    { label: this.translate.instant('Fri'), value: 'fri' },\n    { label: this.translate.instant('Sat'), value: 'sat' },\n  ];\n\n  readonly presets = getDefaultCrontabPresets(this.translate);\n  readonly presetOptions$ = of(this.presets);\n  readonly tooltips = {\n    general: helptextGlobal.scheduler.general.tooltip,\n    minutes: helptextGlobal.scheduler.minutes.tooltip,\n    hours: helptextGlobal.scheduler.hours.tooltip,\n    days: helptextGlobal.scheduler.days.tooltip,\n    orTooltip: helptextGlobal.scheduler.orTooltip,\n  };\n\n  readonly hasOrConditionExplanation$ = this.form.select((values) => {\n    return !this.areAllWeekdaysSelected && values.days !== '*';\n  });\n\n  constructor(\n    private dialogRef: MatDialogRef<SchedulerModalComponent>,\n    private formBuilder: FormBuilder,\n    private translate: TranslateService,\n    private validators: CrontabPartValidatorService,\n    private store$: Store<AppState>,\n    @Inject(MAT_DIALOG_DATA) public config: SchedulerModalConfig,\n  ) {}\n\n  ngOnInit(): void {\n    this.dialogRef.addPanelClass('scheduler-modal');\n    this.generateMonthControls();\n    this.setupFormSubscriptions();\n    this.setInitialValues();\n    this.setTimezone();\n  }\n\n  onDone(): void {\n    this.dialogRef.close(this.crontab);\n  }\n\n  private setInitialValues(): void {\n    if (this.config.crontab) {\n      this.setValuesFromCrontab(this.config.crontab);\n    } else {\n      this.form.patchValue({ preset: this.presets[0].value });\n    }\n    this.crontab = this.getCrontabFromForm();\n  }\n\n  private setTimezone(): void {\n    this.store$.select(selectTimezone).pipe(untilDestroyed(this)).subscribe((timezone) => {\n      this.timezone = timezone;\n      this.crontab = this.getCrontabFromForm();\n    });\n  }\n\n  private setupFormSubscriptions(): void {\n    this.form.controls.preset.valueChanges.pipe(untilDestroyed(this)).subscribe((preset) => {\n      if (!preset) {\n        return;\n      }\n\n      this.setValuesFromCrontab(preset);\n    });\n\n    this.form.valueChanges.pipe(untilDestroyed(this)).subscribe(() => {\n      if (this.form.invalid) {\n        return;\n      }\n\n      this.crontab = this.getCrontabFromForm();\n      this.updatePresetToMatchCrontab();\n    });\n  }\n\n  private generateMonthControls(): void {\n    this.months.forEach((month) => {\n      this.form.controls.months.addControl(month.value as string, new FormControl(false));\n    });\n  }\n\n  private setValuesFromCrontab(crontab: string): void {\n    const [minutes, hours, days] = crontab.split(' ');\n    this.form.patchValue({ minutes, hours, days });\n    try {\n      const parsed = cronParser.parseExpression(crontab);\n\n      const monthValues: Record<string, boolean> = {};\n      this.months.forEach((month) => {\n        monthValues[month.value] = parsed.fields.month.includes(Number(month.value) as MonthRange);\n      });\n\n      const weekdayNumberToWeekday = new Map<DayOfTheWeekRange, string>([\n        [0, 'sun'],\n        [1, 'mon'],\n        [2, 'tue'],\n        [3, 'wed'],\n        [4, 'thu'],\n        [5, 'fri'],\n        [6, 'sat'],\n        [7, 'sun'], // Sunday can be expressed both as 0 and 7\n      ]);\n      const enabledWeekdays = parsed.fields.dayOfWeek.map((weekdayNumber) => {\n        return weekdayNumberToWeekday.get(weekdayNumber);\n      });\n      const weekdayValues: Record<string, boolean> = {};\n      this.weekdays.forEach((weekday) => {\n        weekdayValues[weekday.value] = enabledWeekdays.includes(weekday.value as string);\n      });\n\n      this.form.patchValue({\n        months: monthValues,\n        weekdays: weekdayValues,\n      });\n    } catch (error: unknown) {\n      console.error(error);\n    }\n  }\n\n  private getCrontabFromForm(): string {\n    const {\n      minutes, hours, days, months,\n    } = this.form.value;\n\n    const selectedMonths = Object.entries(months)\n      .filter(([, isSelected]) => isSelected)\n      .map(([month]) => month);\n    const areAllMonthsSelected = selectedMonths.length === 0 || selectedMonths.length === 12;\n    const monthsPart = areAllMonthsSelected ? '*' : selectedMonths.join(',');\n\n    const weekdaysPart = this.areAllWeekdaysSelected ? '*' : this.selectedWeekdays.join(',');\n\n    return [minutes, hours, days, monthsPart, weekdaysPart].join(' ');\n  }\n\n  private get selectedWeekdays(): string[] {\n    return Object.entries(this.form.value.weekdays)\n      .filter(([, isSelected]) => isSelected)\n      .map(([weekday]) => weekday);\n  }\n\n  private get areAllWeekdaysSelected(): boolean {\n    return this.selectedWeekdays.length === 0 || this.selectedWeekdays.length === 7;\n  }\n\n  private updatePresetToMatchCrontab(): void {\n    const matchingPreset = this.presets.some((preset) => {\n      return preset.value === this.crontab;\n    });\n\n    this.form.patchValue({ preset: matchingPreset ? this.crontab : '' }, { emitEvent: false });\n  }\n}\n"],"version":3}